# æ–‡ä»¶æ“ä½œå’Œ I/O

C++ æä¾›äº†å¼ºå¤§çš„æ–‡ä»¶æ“ä½œå’Œ I/O æµåŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ä»¶è¯»å†™ã€æ ¼å¼åŒ–è¾“å‡ºã€å­—ç¬¦ä¸²æµç­‰ã€‚

## æ–‡ä»¶æ“ä½œ

### æ–‡ä»¶è¯»å–

```cpp
#include <iostream>
#include <fstream>
#include <string>

int main() {
    // æ–¹å¼ 1ï¼šé€è¡Œè¯»å–
    std::ifstream file("data.txt");
    if (file.is_open()) {
        std::string line;
        while (std::getline(file, line)) {
            std::cout << line << std::endl;
        }
        file.close();
    } else {
        std::cout << "Cannot open file" << std::endl;
    }
    
    // æ–¹å¼ 2ï¼šè¯»å–æ•´ä¸ªæ–‡ä»¶
    std::ifstream file2("data.txt");
    if (file2.is_open()) {
        std::string content((std::istreambuf_iterator<char>(file2)),
                           std::istreambuf_iterator<char>());
        std::cout << content << std::endl;
        file2.close();
    }
    
    // æ–¹å¼ 3ï¼šè¯»å–åˆ°å­—ç¬¦ä¸²æµ
    std::ifstream file3("data.txt");
    std::stringstream buffer;
    buffer << file3.rdbuf();
    std::string content2 = buffer.str();
    
    return 0;
}
```

### æ–‡ä»¶å†™å…¥

```cpp
#include <iostream>
#include <fstream>
#include <string>

int main() {
    // æ–¹å¼ 1ï¼šæ–‡æœ¬å†™å…¥
    std::ofstream file("output.txt");
    if (file.is_open()) {
        file << "Hello, World!" << std::endl;
        file << "Line 2" << std::endl;
        file.close();
    }
    
    // æ–¹å¼ 2ï¼šè¿½åŠ å†™å…¥
    std::ofstream file2("output.txt", std::ios::app);
    if (file2.is_open()) {
        file2 << "Appended line" << std::endl;
        file2.close();
    }
    
    // æ–¹å¼ 3ï¼šäºŒè¿›åˆ¶å†™å…¥
    std::ofstream file3("binary.bin", std::ios::binary);
    if (file3.is_open()) {
        int data[] = {1, 2, 3, 4, 5};
        file3.write(reinterpret_cast<const char*>(data), sizeof(data));
        file3.close();
    }
    
    return 0;
}
```

### æ–‡ä»¶çŠ¶æ€æ£€æŸ¥

```cpp
#include <iostream>
#include <fstream>
#include <filesystem>  // C++17

int main() {
    std::string filename = "test.txt";
    
    // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ˆC++17ï¼‰
    if (std::filesystem::exists(filename)) {
        std::cout << "File exists" << std::endl;
        
        // è·å–æ–‡ä»¶å¤§å°
        auto size = std::filesystem::file_size(filename);
        std::cout << "File size: " << size << " bytes" << std::endl;
    }
    
    // ä¼ ç»Ÿæ–¹å¼
    std::ifstream file(filename);
    if (file.good()) {
        std::cout << "File is good" << std::endl;
    }
    
    if (file.fail()) {
        std::cout << "File operation failed" << std::endl;
    }
    
    return 0;
}
```

## å­—ç¬¦ä¸²æµ

### std::stringstream

```cpp
#include <iostream>
#include <sstream>
#include <string>

int main() {
    // å­—ç¬¦ä¸²åˆ°å…¶ä»–ç±»å‹
    std::string str = "123";
    std::istringstream iss(str);
    int num;
    iss >> num;
    std::cout << "Number: " << num << std::endl;
    
    // å…¶ä»–ç±»å‹åˆ°å­—ç¬¦ä¸²
    int value = 42;
    std::ostringstream oss;
    oss << "Value: " << value;
    std::string result = oss.str();
    std::cout << result << std::endl;
    
    // æ ¼å¼åŒ–å­—ç¬¦ä¸²
    std::stringstream ss;
    ss << "Name: " << "Alice" << ", Age: " << 25;
    std::cout << ss.str() << std::endl;
    
    // è§£æå­—ç¬¦ä¸²
    std::string data = "10 20 30";
    std::istringstream parser(data);
    int a, b, c;
    parser >> a >> b >> c;
    std::cout << a << ", " << b << ", " << c << std::endl;
    
    return 0;
}
```

## æ ¼å¼åŒ–è¾“å‡º

### åŸºæœ¬æ ¼å¼åŒ–

```cpp
#include <iostream>
#include <iomanip>

int main() {
    int num = 42;
    double pi = 3.14159;
    
    // è®¾ç½®å®½åº¦
    std::cout << std::setw(10) << num << std::endl;
    
    // è®¾ç½®ç²¾åº¦
    std::cout << std::setprecision(2) << pi << std::endl;
    
    // å¡«å……å­—ç¬¦
    std::cout << std::setfill('0') << std::setw(5) << num << std::endl;
    
    // åå…­è¿›åˆ¶
    std::cout << std::hex << num << std::endl;
    
    // å…«è¿›åˆ¶
    std::cout << std::oct << num << std::endl;
    
    // æ¢å¤åè¿›åˆ¶
    std::cout << std::dec << num << std::endl;
    
    return 0;
}
```

### std::formatï¼ˆC++20ï¼‰

```cpp
#include <iostream>
#include <format>

int main() {
    int x = 42;
    double y = 3.14159;
    std::string name = "Alice";
    
    // åŸºæœ¬æ ¼å¼åŒ–
    std::cout << std::format("x = {}, y = {:.2f}", x, y) << std::endl;
    
    // å‘½åå‚æ•°
    std::cout << std::format("Name: {name}, Age: {age}", 
                             std::make_format_args(name, 25)) << std::endl;
    
    // å¯¹é½å’Œå¡«å……
    std::cout << std::format("{:*>10}", x) << std::endl;  // å³å¯¹é½
    std::cout << std::format("{:*<10}", x) << std::endl;  // å·¦å¯¹é½
    std::cout << std::format("{:*^10}", x) << std::endl;  // å±…ä¸­
    
    return 0;
}
```

## å®è·µç»ƒä¹ 

### ç»ƒä¹  1ï¼šCSV æ–‡ä»¶å¤„ç†

```cpp
#include <iostream>
#include <fstream>
#include <sstream>
#include <vector>
#include <string>

std::vector<std::vector<std::string>> read_csv(const std::string& filename) {
    std::vector<std::vector<std::string>> data;
    std::ifstream file(filename);
    
    if (!file.is_open()) {
        throw std::runtime_error("Cannot open file");
    }
    
    std::string line;
    while (std::getline(file, line)) {
        std::vector<std::string> row;
        std::stringstream ss(line);
        std::string cell;
        
        while (std::getline(ss, cell, ',')) {
            row.push_back(cell);
        }
        
        data.push_back(row);
    }
    
    return data;
}

int main() {
    try {
        auto data = read_csv("data.csv");
        for (const auto& row : data) {
            for (const auto& cell : row) {
                std::cout << cell << " ";
            }
            std::cout << std::endl;
        }
    } catch (const std::exception& e) {
        std::cout << "Error: " << e.what() << std::endl;
    }
    
    return 0;
}
```

### ç»ƒä¹  2ï¼šé…ç½®æ–‡ä»¶è¯»å–

```cpp
#include <iostream>
#include <fstream>
#include <map>
#include <string>
#include <sstream>

std::map<std::string, std::string> read_config(const std::string& filename) {
    std::map<std::string, std::string> config;
    std::ifstream file(filename);
    
    if (!file.is_open()) {
        throw std::runtime_error("Cannot open config file");
    }
    
    std::string line;
    while (std::getline(file, line)) {
        if (line.empty() || line[0] == '#') {
            continue;  // è·³è¿‡ç©ºè¡Œå’Œæ³¨é‡Š
        }
        
        std::istringstream iss(line);
        std::string key, value;
        if (std::getline(iss, key, '=') && std::getline(iss, value)) {
            config[key] = value;
        }
    }
    
    return config;
}

int main() {
    try {
        auto config = read_config("config.txt");
        for (const auto& [key, value] : config) {
            std::cout << key << " = " << value << std::endl;
        }
    } catch (const std::exception& e) {
        std::cout << "Error: " << e.what() << std::endl;
    }
    
    return 0;
}
```

## ä¸å…¶ä»–è¯­è¨€å¯¹æ¯”

| ç‰¹æ€§ | C++ | Java | Python | Go | Rust |
|------|-----|------|--------|-----|------|
| **æ–‡ä»¶è¯»å–** | ifstream | FileReader | open() | os.Open | File::open |
| **æ–‡ä»¶å†™å…¥** | ofstream | FileWriter | open('w') | os.Create | File::create |
| **å­—ç¬¦ä¸²æµ** | stringstream | StringBuffer | StringIO | strings.Builder | String |
| **æ ¼å¼åŒ–** | iomanip/format | String.format | f-string | fmt.Printf | format! |

## ä¸‹ä¸€æ­¥

ç°åœ¨ä½ å·²ç»æŒæ¡äº†æ–‡ä»¶æ“ä½œå’Œ I/Oï¼Œå¯ä»¥ç»§ç»­å­¦ä¹ ï¼š

1. **[æ€§èƒ½ä¼˜åŒ–å’Œè°ƒè¯•](./14-æ€§èƒ½ä¼˜åŒ–å’Œè°ƒè¯•.md)** - å­¦ä¹ ä¼˜åŒ–æŠ€å·§
2. å›é¡¾ä¹‹å‰ç« èŠ‚ï¼Œå·©å›ºçŸ¥è¯†

ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼ğŸ‰

